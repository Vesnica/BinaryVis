# BinaryVis 开发任务列表

## 阶段 1: 基础设施搭建（第 1 周）

### 后端基础
- [ ] 初始化 Rust 项目结构
  - [ ] 创建 Cargo.toml 配置
  - [ ] 设置项目目录结构
  - [ ] 配置依赖项

- [ ] 实现基础 HTTP 服务器
  - [ ] Axum 路由设置
  - [ ] 基础中间件配置
  - [ ] CORS 支持
  - [ ] 错误处理框架

- [ ] 文件管理模块
  - [ ] 文件上传接口
  - [ ] 文件存储管理
  - [ ] 内存映射实现
  - [ ] 文件元数据管理

### 前端基础
- [ ] 初始化前端项目
  - [ ] Vite 配置
  - [ ] 项目目录结构
  - [ ] 基础依赖安装

- [ ] 基础 UI 框架
  - [ ] HTML 布局结构
  - [ ] CSS 样式系统
  - [ ] 控制面板骨架
  - [ ] 响应式布局

- [ ] Three.js 集成
  - [ ] 场景初始化
  - [ ] 相机设置
  - [ ] 渲染器配置
  - [ ] 基础光照

## 阶段 2: 核心功能实现（第 2 周）

### 采样系统
- [ ] 采样器接口定义
  - [ ] Trait 定义
  - [ ] 结果类型定义
  - [ ] 元数据结构

- [ ] UniformSampler 实现
  - [ ] 采样算法
  - [ ] 并行处理（Rayon）
  - [ ] 窗口计算逻辑
  - [ ] 数据组装

- [ ] 缓存系统
  - [ ] LRU 缓存实现
  - [ ] 缓存键生成
  - [ ] 内存管理
  - [ ] 缓存统计

### 3D 渲染
- [ ] Trigram 渲染器
  - [ ] 实例化几何体
  - [ ] 顶点着色器
  - [ ] 片段着色器
  - [ ] 坐标变换实现

- [ ] 形状变换
  - [ ] 立方体坐标系
  - [ ] 圆柱体坐标系
  - [ ] 球体坐标系
  - [ ] 形状插值动画

- [ ] 相机控制器
  - [ ] 自动旋转模式
  - [ ] 鼠标交互控制
  - [ ] 键盘控制（可选）

## 阶段 3: 实时通信（第 3 周）

### WebSocket 实现
- [ ] WebSocket 服务器
  - [ ] 连接管理
  - [ ] 消息路由
  - [ ] 错误处理
  - [ ] 连接池管理

- [ ] 消息协议
  - [ ] MessagePack 集成
  - [ ] 消息类型定义
  - [ ] 序列化/反序列化
  - [ ] 协议文档

- [ ] 流式传输
  - [ ] 数据分块
  - [ ] 发送队列管理
  - [ ] 背压处理
  - [ ] 进度跟踪

### 前端通信
- [ ] WebSocket 客户端
  - [ ] 连接管理
  - [ ] 重连逻辑（可选）
  - [ ] 消息处理
  - [ ] 错误处理

- [ ] 数据管理
  - [ ] RingBuffer 实现
  - [ ] 数据块组装
  - [ ] 增量更新
  - [ ] 内存管理

## 阶段 4: 用户界面（第 4 周）

### 控制面板
- [ ] 文件上传组件
  - [ ] 拖放支持
  - [ ] 进度显示
  - [ ] 文件信息展示
  - [ ] 错误提示

- [ ] 采样控制
  - [ ] 大小滑块
  - [ ] 方法选择
  - [ ] 实时预览
  - [ ] 参数验证

- [ ] 渲染控制
  - [ ] 形状切换按钮
  - [ ] 点大小调节
  - [ ] 亮度调节
  - [ ] 颜色配置

- [ ] 状态显示
  - [ ] FPS 计数器
  - [ ] 点数统计
  - [ ] 内存使用
  - [ ] 连接状态

### 错误处理 UI
- [ ] 错误弹窗
  - [ ] 模态框设计
  - [ ] 错误详情显示
  - [ ] 操作按钮
  - [ ] 样式美化

- [ ] 全局错误捕获
  - [ ] window.onerror
  - [ ] Promise rejection
  - [ ] WebSocket 错误
  - [ ] 渲染错误

## 阶段 5: 优化和测试（第 5 周）

### 性能优化
- [ ] 前端优化
  - [ ] 渲染批处理
  - [ ] 内存池管理
  - [ ] 资源懒加载
  - [ ] 代码分割

- [ ] 后端优化
  - [ ] 并发处理优化
  - [ ] 内存使用优化
  - [ ] 缓存策略优化
  - [ ] I/O 优化

### 测试
- [ ] 单元测试
  - [ ] 采样算法测试
  - [ ] 缓存逻辑测试
  - [ ] 坐标变换测试
  - [ ] 工具函数测试

- [ ] 集成测试
  - [ ] API 端点测试
  - [ ] WebSocket 通信测试
  - [ ] 文件上传测试
  - [ ] 端到端流程测试

- [ ] 性能测试
  - [ ] 采样性能基准
  - [ ] 渲染帧率测试
  - [ ] 内存使用测试
  - [ ] 并发压力测试

### 文档
- [ ] API 文档
  - [ ] 接口说明
  - [ ] 示例代码
  - [ ] 错误码表
  - [ ] 版本说明

- [ ] 部署文档
  - [ ] 环境要求
  - [ ] 部署步骤
  - [ ] 配置说明
  - [ ] 故障排查

## 技术债务和改进（未来）

### 待优化项
- [ ] LOD (Level of Detail) 实现
- [ ] 视锥体剔除
- [ ] GPU 计算着色器
- [ ] 增量渲染优化
- [ ] WebAssembly 加速

### 功能扩展
- [ ] Digram 2D 可视化
- [ ] 分层可视化模式
- [ ] 熵值热力图
- [ ] 字节频率分析
- [ ] 导出功能

### 工程化
- [ ] CI/CD 配置
- [ ] Docker 镜像构建
- [ ] 自动化测试
- [ ] 性能监控
- [ ] 日志聚合

## 开发规范

### 代码规范
- 使用 `cargo fmt` 格式化 Rust 代码
- 使用 `cargo clippy` 进行代码检查
- JavaScript 代码遵循 ES2022 标准
- 所有错误必须向上传播（Fast-fail）

### Git 规范
- 功能分支命名：`feature/功能名称`
- 修复分支命名：`fix/问题描述`
- 提交信息格式：`类型: 描述`
  - feat: 新功能
  - fix: 修复
  - docs: 文档
  - style: 格式
  - refactor: 重构
  - test: 测试
  - chore: 构建

### 测试规范
- 单元测试覆盖率 > 80%
- 所有 API 必须有集成测试
- 性能关键路径必须有基准测试
- PR 合并前必须通过所有测试

## 里程碑

| 里程碑 | 目标日期 | 交付物 |
|-------|---------|--------|
| M1: 基础框架 | 第 1 周末 | 可运行的前后端框架 |
| M2: 核心功能 | 第 2 周末 | 文件上传和基础 3D 渲染 |
| M3: 实时通信 | 第 3 周末 | WebSocket 流式传输 |
| M4: 完整 MVP | 第 4 周末 | 可用的最小可行产品 |
| M5: 发布版本 | 第 5 周末 | 优化和测试完成的 v1.0 |

## 风险和缓解

| 风险 | 影响 | 缓解措施 |
|-----|------|----------|
| WebGL 兼容性问题 | 高 | 提供 WebGL2 降级方案 |
| 大文件内存溢出 | 高 | 严格的大小限制和流式处理 |
| WebSocket 连接不稳定 | 中 | 实现心跳机制 |
| 渲染性能不足 | 中 | 实现 LOD 和批处理 |
| 浏览器差异 | 低 | 充分测试主流浏览器 |

## 依赖项清单

### 后端 (Cargo.toml)
```toml
[dependencies]
tokio = { version = "1.35", features = ["full"] }
axum = { version = "0.7", features = ["ws"] }
tower = "0.4"
tower-http = { version = "0.5", features = ["cors"] }
memmap2 = "0.9"
rayon = "1.8"
rmp-serde = "1.1"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
uuid = { version = "1.6", features = ["v4"] }
anyhow = "1.0"
tracing = "0.1"
tracing-subscriber = "0.3"
bytes = "1.5"
rand = "0.8"
base64 = "0.21"
chrono = "0.4"
```

### 前端 (package.json)
```json
{
  "dependencies": {
    "three": "^0.160.0",
    "@msgpack/msgpack": "^3.0.0"
  },
  "devDependencies": {
    "vite": "^5.0.0"
  }
}
```

## 完成标准

每个任务的完成标准：
1. ✅ 代码实现完成
2. ✅ 单元测试通过
3. ✅ 代码审查通过
4. ✅ 文档更新完成
5. ✅ 集成测试通过

## 注意事项

1. **Fast-fail 原则**：所有错误直接报错，不做降级处理
2. **最小依赖**：只使用必要的第三方库
3. **性能优先**：每个功能都要考虑性能影响
4. **安全第一**：所有输入必须验证
5. **及时沟通**：遇到阻塞立即上报